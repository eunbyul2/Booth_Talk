# 전시회 기반 이벤트 시스템 구조

## 📋 개요

`/visitor/events` 페이지를 전시회(Exhibition) 중심 구조로 변경했습니다.

### 변경 전 vs 변경 후

**변경 전:**
- 개별 이벤트만 표시
- 이벤트 간 연관성 없음

**변경 후:**
- 상단: 전시회 정보 (행사명, 기간, 장소)
- 하단: 해당 전시회의 부스별 이벤트 리스트

## 🗄️ 데이터베이스 구조

### 1. exhibitions (전시회) 테이블

```
exhibitions
├── id (PK)
├── venue_id (FK → venues)
├── exhibition_name        "2025 코엑스 푸드위크"
├── exhibition_code        "S0902"
├── start_date            "2025-10-29"
├── end_date              "2025-11-01"
├── hall_info             "제1전시관 A, B, C"
├── description
├── organizer             "한국식품산업협회"
└── poster_image_url
```

### 2. events (이벤트) 테이블

```
events
├── id (PK)
├── company_id (FK → companies)
├── exhibition_id (FK → exhibitions)  ⭐ 새로 추가
├── venue_id (FK → venues)
├── event_name            "[S0902] 농업회사법인(주)해남진호드모"
├── booth_number          "B5001"
├── event_date            "2025-10-29"
├── event_time            "11:00:00"
├── end_date              "2025-11-01"
├── end_time              "15:00:00"
├── time_slots            ["11:00", "13:00", "14:00", "15:00"]  ⭐ 새로 추가
├── description           "당일 조달로 시작"
├── benefits              "무료 시식, 할인 쿠폰 제공"
└── poster_image_url
```

### 관계도

```
exhibitions (1) ─────┐
                     │
                     │ has many
                     │
                     ├─── events (N)
                     │
venues (1) ──────────┤
                     │
companies (1) ───────┘
```

## 📱 화면 레이아웃

```
┌──────────────────────────────────────────┐
│  📅 10.29(수) 11:00                      │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │  🎪 2025 코엑스 푸드위크           │ │
│  │  📆 2025.10.29(수) ~ 11.1(토)      │ │
│  │  📍 제1전시관 A, B, C              │ │
│  └────────────────────────────────────┘ │
│                                          │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                          │
│  참여 업체 이벤트                        │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │ 🏢 [S0902] 농업회사법인(주)해남... │ │
│  │ ⏰ 11:00 / 13:00 / 14:00 / 15:00   │▶│
│  │ 📝 당일 조달로 시작                │ │
│  │ 🎁 무료 시식, 할인 쿠폰 제공       │ │
│  └────────────────────────────────────┘ │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │ 🏢 [B5201] (주)대일피비            │ │
│  │ ⏰ 11:00 / 13:00 / 14:00 / 15:00   │▶│
│  │ 📝 세계각국의 맛을 시음            │ │
│  │ 🎁 무료 시식, 경품 추첨            │ │
│  └────────────────────────────────────┘ │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │ 🏢 [특별관] 헬스클럽레저 컴퍼니    │ │
│  │ ⏰ 10:00 / 12:00 / 14:00 / 16:00   │▶│
│  │ 📝 헬시플레저 라이프 공유소        │ │
│  │ 🎁 건강 상담, 샘플 증정            │ │
│  └────────────────────────────────────┘ │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │ 🏢 [B5001] 협찬투어                │ │
│  │ ⏰ 10:00 / 12:00 / 14:00 / 16:00   │▶│
│  │ 📝 스페인 타파스 문화 체험...      │ │
│  │ 🎁 여행 상담, 할인 쿠폰            │ │
│  └────────────────────────────────────┘ │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │ 🏢 [S0902] 농업회사법인(주)해남... │ │
│  │ ⏰ 11:00 / 13:00 / 14:00 / 15:00   │▶│
│  │ 📝 당일 조달로 시작                │ │
│  │ 🎁 무료 시식, 기념품 증정          │ │
│  └────────────────────────────────────┘ │
│                                          │
└──────────────────────────────────────────┘
```

## 📊 샘플 데이터

### 전시회 (1개)
```sql
{
  "id": 1,
  "exhibition_name": "2025 코엑스 푸드위크",
  "exhibition_code": "S0902",
  "start_date": "2025-10-29",
  "end_date": "2025-11-01",
  "hall_info": "제1전시관 A, B, C",
  "venue_name": "코엑스"
}
```

### 이벤트 (5개)
모두 위 전시회에 속함

| ID | 업체명 | 부스 | 시간대 |
|----|--------|------|--------|
| 1 | 농업회사법인 | B5001 | 11:00, 13:00, 14:00, 15:00 |
| 2 | (주)대일피비 | B5201 | 11:00, 13:00, 14:00, 15:00 |
| 3 | 특별한헬스클럽 | A-312 | 10:00, 12:00, 14:00, 16:00 |
| 4 | 협찬투어 | B5001 | 10:00, 12:00, 14:00, 16:00 |
| 5 | 농업회사법인 | S0902 | 11:00, 13:00, 14:00, 15:00 |

## 🔧 구현 상태

### ✅ 완료된 작업
- [x] `exhibitions` 테이블 생성
- [x] `events` 테이블에 `exhibition_id`, `time_slots` 추가
- [x] 인덱스 및 트리거 업데이트
- [x] `v_events_with_details` 뷰 업데이트
- [x] 샘플 데이터 5개 생성

### ⏳ 다음 작업 (Frontend 반영 시)
- [ ] Backend API 수정 (`/api/visitor/events`)
  - exhibition 정보 포함하여 반환
  - time_slots 배열 처리
- [ ] Frontend 컴포넌트 수정 (`EventList.jsx`)
  - 상단: 전시회 정보 카드
  - 하단: 이벤트 리스트
  - 시간대 표시 (time_slots)

## 🚀 데이터베이스 적용 방법

### 새로 설치하는 경우
```bash
# PostgreSQL 접속
psql -U postgres

# schema.sql 실행
\i d:/Booth_Talk/database/schema.sql
```

### 기존 DB가 있는 경우
```sql
-- 1. exhibitions 테이블 생성
-- 2. events 테이블 수정
ALTER TABLE events ADD COLUMN exhibition_id INTEGER REFERENCES exhibitions(id);
ALTER TABLE events ADD COLUMN time_slots TEXT[];

-- 3. 인덱스 추가
CREATE INDEX idx_events_exhibition_id ON events(exhibition_id);
CREATE INDEX idx_events_time_slots ON events USING GIN(time_slots);

-- 4. 뷰 재생성
DROP VIEW IF EXISTS v_events_with_details;
-- (schema.sql의 뷰 생성 코드 실행)
```

## 📝 주요 변경 포인트

1. **전시회 중심 구조**
   - 하나의 전시회에 여러 부스/업체 이벤트가 속함
   - 전시회 정보를 상단에 표시

2. **시간대 배열 (time_slots)**
   - 하나의 이벤트가 여러 시간대에 진행 가능
   - 예: `["11:00", "13:00", "14:00", "15:00"]`

3. **부스 번호 (booth_number)**
   - 각 업체마다 고유한 부스 번호
   - 이벤트명에도 포함 가능

4. **이미지 URL**
   - 각 이벤트마다 대표 이미지
   - 현재는 placeholder 사용

## 💡 참고사항

- 모든 샘플 데이터는 같은 전시회(2025 코엑스 푸드위크)에 속함
- 실제 사용 시 여러 전시회를 동시에 운영 가능
- Frontend에서 exhibition_id로 필터링하여 특정 전시회의 이벤트만 표시
- 데이터베이스 연결 후 바로 사용 가능한 상태
